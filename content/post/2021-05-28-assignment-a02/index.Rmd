---
title: Assignment A02
author: Rajneetk
date: '2021-05-28'
slug: assignment-a02
categories:
  - Data analytics
tags: []
---


---
title: Assignment A02
author: Rajneetk
date: '2021-05-26'
slug: assignment-a02
categories: []
tags: []
---


Exploring Phishing Dataset for Machine Learning with Tidyverse.


Description:

The Phishing dataset is downloaded from kaggle website.


1) Dataset information

   This dataset contains 48 features taken from 5000 phishing web pages and 5000 legitimate web pages downloaded         between January and May and June 2015. 


2) Tidyverse and dplyr library would be used.



## Importing data from phishing.csv file


```{r, warning=FALSE}

library(tidyverse)
library(gridExtra)
library(dplyr)

phishing <- read_csv("phishing.csv")
head(phishing)
names(phishing)

```


## One table verb

  1) Select to keep variables, here NumDots and SubdomainLevel is kept.

```{r}
phishing %>%
  select(NumDots, SubdomainLevel)
  
```


  2) Arrange in ascending / descending order:
      
     HostnameLength is arranged in descending order.

```{r}
library(dplyr)
library(tidyverse)

phishing %>%
  select(id, EmbeddedBrandName,UrlLength,SubdomainLevel, PathLevel,HostnameLength) %>%
  arrange(desc(HostnameLength)) 
   
```

  3) mutate to add a new variable:
  
     Mutating joins allow you to combine variables from multiple tables.HostnameLength_PathLength is added as a new       variable by mutate.

```{r}
phishing %>%
  mutate(HostnameLength_PathLength = HostnameLength + PathLength) %>%
  select(HostnameLength, PathLength, HostnameLength_PathLength) %>%
  arrange(desc(HostnameLength_PathLength))
```


## Two table verbs

A single data table is rare for a data analysis.We usually have a number of tables for analysis and flexible tools to bring them together.

  1) Left_join: 
     The left_join keyword returns all records from the left table (table_1), and the matching records from the           right table (table_2).

```{r}
library(dplyr)
library(tidyverse)

table_1  <- phishing   %>%
  select(id,AbnormalExtFormActionR,PctExtResourceUrlsRT)
table_2 <- phishing  %>%
  select(id,MissingTitle,ImagesOnlyInForm)


table_1
table_2

table_1  %>%  left_join(table_2)
```


  2) full_join():
     Keeps all of the entries in both tables, regardless of whether or not they appear in the other table.
   
```{r}

library(dplyr)
library(tidyverse)

table_3  <- phishing  %>%
  select(id,InsecureForms,RelativeFormAction,ExtFormAction)
table_4 <- phishing  %>%
  select(id,PctExtHyperlinks,PctExtResourceUrls)


table_3
table_4

table_3  %>%  full_join(table_4)

```



## Grouping 

Most data operations are done on groups defined by variables group_by() and converts it into a group where operations are performed "by group". ungroup() removes grouping.

  1)Summarize with groups:
    It allows us to get a summary row for each group.
 
```{r}
library(dplyr)
library(tidyverse)

  
  phishing %>% 
  group_by(AbnormalExtFormActionR) %>% 
  summarize(mean_phishing  = mean(phishing ),
  max_phishing = max(phishing),
            count = n())
```


  2) summarise() removes a layer of grouping
 
```{r}

by_NumDots_SubdomainLevel <- phishing %>% 
  group_by(NumDots, SubdomainLevel)

by_NumDots <- by_NumDots_SubdomainLevel %>% 
  summarise(n = n())
by_NumDots

phishing %>% 
  group_by(NumDots_SubdomainLevel = NumDots + SubdomainLevel)

```



## Vector function

  1)logical operators applied to generate output with rows of data where column PathLevel is between 1 and 5             and rows of data where column NumDash is equal to 1 and column DomainInPaths is not 0.
 
```{r}
v <- phishing


 v[v$PathLevel > 1 & v$PathLevel < 5,]
 v[v$NumDash == 1 & v$DomainInPaths  != 0,]
 
```
 
  2) Vectors can be constructed with c(), :, or seq().

```{r}

5:10
c(seq(2,20,by=2),seq(1,20,by=2))
phishing[c(1,3,5,7,9),]

```



## Pivoting

Describes the use of the new pivot_longer() and pivot_wider() functions. Their goal is to improve the usability of gather() and spread().

  1) pivot_longer:
     increasing the number of rows and decreasing the number of columns.
   
```{r}

library(tidyverse)

pivot_longer(
 phishing,
  NumDots, 
  names_to = "NumDots old", 
  values_to = "NumDots new"
  )

```

  2) pivot_wider:
     Widens data, increasing the number of columns and decreasing the number of rows. The inverse transformation is       pivot_longer().

```{r}

phishing %>%
  select(SubdomainLevelRT, UrlLengthRT) %>%
  add_count(SubdomainLevelRT, name = "SubdomainLevelRT_n") %>%
  pivot_wider(
    names_from = SubdomainLevelRT,
    values_from = SubdomainLevelRT_n,
    names_prefix = "SubdomainLevelRT_",
    values_fn = list(SubdomainLevelRT_n = mean)
  )
    
```


## Missing value

The phishing dataset has some missing values.

  Following are the 3 tidyr functions that are handy for processing Missing Values

  1) drop_na()-drops/removes the rows/entries with Missing Values
  2) fill()- fills the NAs (missing values) in selected columns 
  3) replace_na()-used when you have got the replacement value which the NAs should be filled with.
  
```{r}

library(dplyr)

df <- phishing

df$RightClickDisabled[2] <- NA
df$NumDash[5] <- NA
df$NumDashInHostname[5] <- NA
df$SubdomainLevel[10] <- NA

# counting number of missing values
paste("Number of Missing Values", sum(is.na(df)))

df_no_na <- drop_na(df)
paste("Number of Missing Values", sum(is.na(df_no_na)))

paste("Number of Rows",nrow(df_no_na))
paste("Number of Columns",ncol(df_no_na))



df_na_filled <- df %>% 
                    fill(
                      dplyr::everything()
                    )


# counting number of missing values
paste("Number of Missing Values", sum(is.na(df_na_filled)))
paste("Number of Rows",nrow(df_na_filled))
paste("Number of Columns",ncol(df_na_filled))

# replaced their values with NAs
df_na_replaced <- df %>% 
                    mutate_if(is.numeric, replace_na,0)

```
